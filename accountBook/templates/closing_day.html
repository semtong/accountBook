{% extends 'base.html' %}

<!--통화 및 시간표시 기능-->
{% load humanize %}

{% block stylesheet %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
{% endblock %}

{% block breadcrumb %}
    <li class="breadcrumb-item"><a href="{% url 'home' %}"> Main </a></li>
    <li class="breadcrumb-item"><a href="{% url 'history_main' name.pk %}">{{ name.account_name }} </a></li>
    <li class="breadcrumb-item active"> 결산하기 </li>
{% endblock %}

{% block contents %}
    <nav class="navbar navbar-light" style="background-color: #e3f2fd; margin-bottom: 10px;">
        <h2>{{ year }} 년 {{ month }} 월달 현재 누적금액</h2>
            {% if history_name == 'k' %}
        <h2>{{ sum|intcomma }}원</h2>
            {% else %}
        <h2>{{ sum|intcomma }}엔</h2>
            {% endif %}
    </nav>

    <table class="table table-sm">
        <thead>
            <tr>
                {% for i in user_list %}
                    <th scope="col" class="table-dark">{{ i.user_id.username }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            <tr>
                {% for i in user_list %}
                    <td class="table-light">
                        {{ div|intcomma }}
                        {% if history_name == 'k' %}
                            원
                        {% else %}
                            엔
                        {% endif %}
                    </td>
               {% endfor %}
            </tr>
        </tbody>
    </table>

    <nav>
        <div class="nav nav-tabs" id="nav-tab" role="tablist">
            {% for i in user_list %}
                {% if i.user_id.username == user.username %}
                    <a class="nav-item nav-link active" id="nav-home-tab_{{ i.user_id }}" data-toggle="tab" href="#nav-{{ i.user_id }}" role="tab" aria-controls="nav-{{ i.user_id }}" aria-selected="true">
                        <input type="hidden" id="initial_id" value="{{i.user_id}}">
                        {{ i.user_id }}
                    </a>
                {% else %}
                    <a class="nav-item nav-link" id="nav-home-tab_{{ i.user_id }}" data-toggle="tab" href="#nav-{{ i.user_id }}" role="tab" aria-controls="nav-{{ i.user_id }}" aria-selected="false">
                        {{ i.user_id|intcomma }}
                    </a>
                {% endif %}
            {% endfor %}
        </div>

    </nav>

    <div class="tab-content" id="nav-tabContent" style="background-color:white;">
        {% for i in user_list %}
            {% if i.user_id.username == user.username %}
                <div class="tab-pane fade show active" id="nav-{{ i.user_id }}" role="tabpanel" aria-labelledby="nav-home-tab">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th scope="col" class="table-info">Use History</th>
                                <th scope="col" class="table-info">Price</th>
                                <th scope="col" class="table-info">Pay</th>
                                <th scope="col" class="table-info">Writer</th>
                                <th scope="col" class="table-info">Create at</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for i in history %}
                                <tr>
                                    <td scope="row">
                                        <input type="checkbox" class="checkbox" value="{{i.pk}}" onclick="get_price({{i.val}})" checked> {{ i.use_history }}
                                    </td>
                                    <td>
                                        {{ i.price|intcomma }}
                                    </td>
                                    <td>
                                        {{ i.val|intcomma }}
                                    </td>
                                    <td>
                                        {{ i.user }}
                                    </td>
                                    <td>
                                        {{ i.create_at|naturaltime }}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <div class="tab-pane fade" id="nav-{{ i.user_id }}" role="tabpanel" aria-labelledby="nav-profile-tab">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th scope="col" class="table-info">Use History</th>
                                <th scope="col" class="table-info">Price</th>
                                <th scope="col" class="table-info">Pay</th>
                                <th scope="col" class="table-info">Writer</th>
                                <th scope="col" class="table-info">Create at</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for i in history %}
                                <tr>
                                    <td scope="row">
                                        <input type="checkbox" class="checkbox" value="{{i.pk}}" checked> {{ i.use_history }}
                                    </td>
                                    <td>
                                        {{ i.price|intcomma }}
                                    </td>
                                    <td>
                                        {{ i.val|intcomma }}
                                    </td>
                                    <td>
                                        {{ i.user }}
                                    </td>
                                    <td>
                                        {{ i.create_at|naturaltime }}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% endif %}
        {% endfor %}
    </div>

<script>


</script>

{% endblock %}